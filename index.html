<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5S9FWFB');</script>
<!-- End Google Tag Manager -->
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
<script
  async
  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1803570349020443"
  crossorigin="anonymous"
></script>
  
<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="A Software Engineer &amp;&amp; A Basketball Fanatic &amp;&amp; An Alcoholic">
<meta property="og:type" content="website">
<meta property="og:title" content="小小書僮，可笑可笑">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="小小書僮，可笑可笑">
<meta property="og:description" content="A Software Engineer &amp;&amp; A Basketball Fanatic &amp;&amp; An Alcoholic">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Leo Lee">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>小小書僮，可笑可笑</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5S9FWFB"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">小小書僮，可笑可笑</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">murmrur</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/27/React-Next-Mysql-In-Docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Leo Lee">
      <meta itemprop="description" content="A Software Engineer && A Basketball Fanatic && An Alcoholic">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小書僮，可笑可笑">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/27/React-Next-Mysql-In-Docker/" class="post-title-link" itemprop="url">打包React/Next/Mysql到Docker帶走</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-12-27 00:16:33" itemprop="dateCreated datePublished" datetime="2022-12-27T00:16:33+08:00">2022-12-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-28 11:06:13" itemprop="dateModified" datetime="2022-12-28T11:06:13+08:00">2022-12-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前情提要"><a href="#前情提要" class="headerlink" title="前情提要"></a>前情提要</h1><p>最近面試發現 React 的職缺比較多，剛好藉由某次 pre-interview exam 來學習一下並做筆記</p>
<h1 id="Tech-Stacks"><a href="#Tech-Stacks" class="headerlink" title="Tech Stacks"></a>Tech Stacks</h1><ul>
<li>react</li>
<li>next</li>
<li>mui</li>
<li>axios</li>
<li>mysql</li>
<li>docker</li>
</ul>
<h2 id="利用-create-react-app-create-next-app-init-project"><a href="#利用-create-react-app-create-next-app-init-project" class="headerlink" title="利用 create-react-app / create-next-app init project"></a>利用 create-react-app / create-next-app init project</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app@latest</span><br><span class="line">npx create-next-app@latest</span><br></pre></td></tr></table></figure>

<h2 id="使用-material-ui-作為-UI-compnent"><a href="#使用-material-ui-作為-UI-compnent" class="headerlink" title="使用 material ui 作為 UI compnent"></a>使用 material ui 作為 UI compnent</h2><ul>
<li>5.x 版 style 已經不可使用</li>
<li>其中使用了 componets Card/Divider/Grid/TextField/Autocomplete/Typography</li>
</ul>
<h2 id="資料庫使用-mysql"><a href="#資料庫使用-mysql" class="headerlink" title="資料庫使用 mysql"></a>資料庫使用 mysql</h2><ul>
<li>因為資料來源為.csv 檔，所以使用 import 工具來建立 table and data<br><img src="/2022/12/27/React-Next-Mysql-In-Docker/capture01.png"></li>
<li>加上 PK 與關聯式資料<br><img src="/2022/12/27/React-Next-Mysql-In-Docker/capture01.png"></li>
</ul>
<h2 id="mysql2-作為-nodejs-to-mysql-的工具"><a href="#mysql2-作為-nodejs-to-mysql-的工具" class="headerlink" title="mysql2 作為 nodejs to mysql 的工具"></a>mysql2 作為 nodejs to mysql 的工具</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/mysql2">https://www.npmjs.com/package/mysql2</a></li>
<li>設定 connector</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&quot;mysql2/promise&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">dbConnector</span> &#123;</span><br><span class="line">  config;</span><br><span class="line">  connection;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">config</span> = config || &#123;</span><br><span class="line">      <span class="attr">host</span>: <span class="string">&quot;172.30.0.2&quot;</span>, <span class="comment">//for docker. host: &quot;127.0.0.1&quot;, //for dev.</span></span><br><span class="line">      <span class="attr">port</span>: <span class="string">&quot;3306&quot;</span>,</span><br><span class="line">      <span class="attr">user</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">      <span class="attr">password</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">      <span class="attr">database</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">connect</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">connection</span> = <span class="keyword">await</span> mysql.<span class="title function_">createConnection</span>(<span class="variable language_">this</span>.<span class="property">config</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">execute</span>(<span class="params">sql</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> conn = <span class="keyword">await</span> mysql.<span class="title function_">createConnection</span>(<span class="variable language_">this</span>.<span class="property">config</span>);</span><br><span class="line">    <span class="keyword">const</span> [rows, fields] = <span class="keyword">await</span> conn.<span class="title function_">execute</span>(sql);</span><br><span class="line">    <span class="comment">// console.log(&quot;execute!&quot;, rows, fields);</span></span><br><span class="line">    <span class="keyword">await</span> conn.<span class="title function_">end</span>();</span><br><span class="line">    <span class="keyword">return</span> [rows, fields];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = dbConnector;</span><br></pre></td></tr></table></figure>

<h2 id="意外發現-Nextjs-也可以寫-API"><a href="#意外發現-Nextjs-也可以寫-API" class="headerlink" title="意外發現 Nextjs 也可以寫 API"></a>意外發現 Nextjs 也可以寫 API</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> connector = <span class="built_in">require</span>(<span class="string">&quot;../../../database/dbConnector&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getMovies</span>(<span class="params">Id</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> conn = <span class="keyword">new</span> <span class="title function_">connector</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> sql = <span class="string">`SELECT * FROM test.movies <span class="subst">$&#123;Id ? <span class="string">&quot;WHERE Id = &quot;</span> + Id : <span class="string">&quot;&quot;</span>&#125;</span>`</span>;</span><br><span class="line">  <span class="keyword">const</span> [rows] = <span class="keyword">await</span> conn.<span class="title function_">execute</span>(sql);</span><br><span class="line">  <span class="keyword">const</span> movies = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> row <span class="keyword">in</span> rows) &#123;</span><br><span class="line">    <span class="keyword">const</span> movie = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> col <span class="keyword">in</span> rows[row]) &#123;</span><br><span class="line">      movie[col] = rows[row][col];</span><br><span class="line">    &#125;</span><br><span class="line">    movies.<span class="title function_">push</span>(movie);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> movies;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handler</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> movies = <span class="keyword">await</span> <span class="title function_">getMovies</span>(req.<span class="property">query</span>.<span class="property">Id</span>);</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(movies);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="使用-reduxjs-toolkit-讓撰寫-redux-更方便"><a href="#使用-reduxjs-toolkit-讓撰寫-redux-更方便" class="headerlink" title="使用 reduxjs/toolkit 讓撰寫 redux 更方便"></a>使用 reduxjs/toolkit 讓撰寫 redux 更方便</h2><p><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/@reduxjs/toolkit">https://www.npmjs.com/package/@reduxjs/toolkit</a></p>
<h2 id="撰寫-docker-file-製作-app-image"><a href="#撰寫-docker-file-製作-app-image" class="headerlink" title="撰寫 docker file 製作 app image"></a>撰寫 docker file 製作 app image</h2><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">18</span>-alpine AS build</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> /app ./</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yarn &amp;&amp; yarn build</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> node:<span class="number">18</span>-alpine AS deploy</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=build /app/package.json ./package.json</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=build /app/node_modules ./node_modules</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=build /app/.next ./.next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">3000</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [ <span class="string">&quot;yarn&quot;</span>, <span class="string">&quot;start&quot;</span> ]</span></span><br></pre></td></tr></table></figure>

<h2 id="打包-Mysql-與-schema"><a href="#打包-Mysql-與-schema" class="headerlink" title="打包 Mysql 與 schema"></a>打包 Mysql 與 schema</h2><ul>
<li>先從 mysql workbench 匯出 schema 跟資料</li>
<li>放入相對應的 volumes</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">db</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_USER:</span> <span class="string">test</span></span><br><span class="line">      <span class="attr">MYSQL_PASSWORD:</span> <span class="string">test</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="number">123456</span></span><br><span class="line">      <span class="attr">MYSQL_DATABASE:</span> <span class="string">test</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:3306</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./sqls:/docker-entrypoint-initdb.d</span></span><br></pre></td></tr></table></figure>

<h2 id="撰寫-ddocker-compose-製作-database-and-app-環境"><a href="#撰寫-ddocker-compose-製作-database-and-app-環境" class="headerlink" title="撰寫 ddocker-compose 製作 database and app 環境"></a>撰寫 ddocker-compose 製作 database and app 環境</h2><ul>
<li>期間為了讓 app 可以取用 database 的網路，搞了老半天，一開始使用最簡單的方法 network_mode 設定為 host 一直無法成功，最後還是使用 brige 的方式…</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">db</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_USER:</span> <span class="string">test</span></span><br><span class="line">      <span class="attr">MYSQL_PASSWORD:</span> <span class="string">test</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="number">123456</span></span><br><span class="line">      <span class="attr">MYSQL_DATABASE:</span> <span class="string">test</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:3306</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./sqls:/docker-entrypoint-initdb.d</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">test:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">172.30</span><span class="number">.0</span><span class="number">.2</span></span><br><span class="line">  <span class="attr">app:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">app</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">app</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">Dockerfile</span></span><br><span class="line">      <span class="attr">target:</span> <span class="string">deploy</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8081</span><span class="string">:3000</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">test:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">172.30</span><span class="number">.0</span><span class="number">.3</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">test:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br><span class="line">    <span class="attr">ipam:</span></span><br><span class="line">      <span class="attr">driver:</span> <span class="string">default</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">subnet:</span> <span class="number">172.30</span><span class="number">.0</span><span class="number">.0</span><span class="string">/16</span></span><br><span class="line">          <span class="attr">gateway:</span> <span class="number">172.30</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>

<h2 id="將-images-推上火坑-docker-hub"><a href="#將-images-推上火坑-docker-hub" class="headerlink" title="將 images 推上火坑(docker hub)"></a>將 images 推上火坑(docker hub)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker tag SOURCE_IMAGE[:TAG] TARGET_IMAGE[:TAG]</span><br><span class="line">docker push [OPTIONS] NAME[:TAG]</span><br></pre></td></tr></table></figure>

<h2 id="修改-docker-compose-yml-的-image-由-docker-hub-取得"><a href="#修改-docker-compose-yml-的-image-由-docker-hub-取得" class="headerlink" title="修改 docker-compose.yml 的 image 由 docker hub 取得"></a>修改 docker-compose.yml 的 image 由 docker hub 取得</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">db</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">kidd1118/mysql</span></span><br><span class="line">    <span class="string">。。。略</span></span><br><span class="line">  <span class="attr">app:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">app</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">kidd1118/app</span></span><br><span class="line">    <span class="string">。。。略</span></span><br></pre></td></tr></table></figure>

<h2 id="之後-compose-up-就完工啦-cheers"><a href="#之後-compose-up-就完工啦-cheers" class="headerlink" title="之後 compose up 就完工啦!!!!cheers"></a>之後 compose up 就完工啦!!!!cheers</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/17/Xeunn-Traveling/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Leo Lee">
      <meta itemprop="description" content="A Software Engineer && A Basketball Fanatic && An Alcoholic">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小書僮，可笑可笑">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/17/Xeunn-Traveling/" class="post-title-link" itemprop="url">在Xuenn的旅程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-10-17 16:32:22" itemprop="dateCreated datePublished" datetime="2022-10-17T16:32:22+08:00">2022-10-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-28 11:06:13" itemprop="dateModified" datetime="2022-12-28T11:06:13+08:00">2022-12-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="紀錄職涯的一個階段"><a href="#紀錄職涯的一個階段" class="headerlink" title="紀錄職涯的一個階段"></a>紀錄職涯的一個階段</h1><p>年資: 6 年 2 個月<br>始業職位: Engineer,App<br>結業職位: Associate Principal Engineer,App</p>
<h2 id="Engineer-App-2016-09-2020-04"><a href="#Engineer-App-2016-09-2020-04" class="headerlink" title="Engineer,App 2016/09 ~ 2020/04"></a>Engineer,App 2016/09 ~ 2020/04</h2><p>初始部門產品為真人和官與角子老虎機，剛進公司時為了擴展產品線，將兩個產品分離，加入了角子老虎機的部門<br>角子老虎機初期使用 flash 開發，因 flash 要被淘汰，所以首要任務是把目前所有的 flash 遊戲轉為 html5</p>
<p>現有 flash 角子老虎機遊戲都翻為 html5 後，並持續開發新遊戲，並且將產品架構重整，並加上了許多 fancy 的功能<br>遊戲公仔，Low / High Qaulity Switch，Runtime 改變場景 layout，Cash Mode，4-in-1，龍虎榜，大獎榜等…</p>
<h3 id="Native-Game"><a href="#Native-Game" class="headerlink" title="Native Game"></a>Native Game</h3><p>也因想要增進使用者體驗，因而想開發 native 的遊戲，不再是使用 webview 去 launch html5 的遊戲，我也擔任了 native game project lead 的角色<br>經過一陣子的 POC 評估，最終選擇了使用 Unit 作為解決方案，初期也是藉由翻寫 Html5 遊戲的方式去做 native 的遊戲<br>過程中也算順利，Unit 與 iOS/Android 框架整合後，認為使用 Unit 遊戲做出來的 library 太大(實際上已經 fine tune 到 20-30MB，市面上相同類型遊戲都要 100MB up)<br>因而中止了 native 遊戲的開發，雖說 project 失敗，但其實過程中也學到了不少東西。</p>
<h3 id="Table-Game"><a href="#Table-Game" class="headerlink" title="Table Game"></a>Table Game</h3><p>角子老虎機遊戲因市場競爭大，Business 方想改做棋牌類遊戲，因此做了第一款棋牌遊戲，初上線時，為我們帶了不錯的營收，讓 Business 方更有信心持續改做棋牌遊戲，之後也陸續做了多款單人，多人棋牌。</p>
<h2 id="Senior-Engineer-App-2020-05-2021-04"><a href="#Senior-Engineer-App-2020-05-2021-04" class="headerlink" title="Senior Engineer,App 2020/05 ~ 2021/04"></a>Senior Engineer,App 2020/05 ~ 2021/04</h2><h2 id="Associate-Principal-Engineer-App-2021-05-2022-10"><a href="#Associate-Principal-Engineer-App-2021-05-2022-10" class="headerlink" title="Associate Principal Engineer,App 2021/05 ~ 2022/10"></a>Associate Principal Engineer,App 2021/05 ~ 2022/10</h2><p>在前三年因為表現超出預期，因此也得到了升遷的機會，我覺得主因還是因為喜愛產品，一些前 Senior 離職時，自動去 pick up 了許多工作，因為想要更了解產品，剛好有更多的機會去學習不同東西，期間接收了許多 CI/CD 流程的改進，ELK Dashboard / Watcher 等 monitoring 的建置，並主動去發覺改進架構與問題(有時候是逼不得已的 XD)，我對於產品的面相看的更全面，不再只有著重於開發，是需要很多環節去串聯，才可以做出一個好產品。</p>
<h3 id="Frontend-Lead"><a href="#Frontend-Lead" class="headerlink" title="Frontend Lead"></a>Frontend Lead</h3><p>期間做了許多前端架構與流程的改進，規劃並把前端架構改善且自建了 priviate NPM，並把共用 module 與工具發佈至上面。改善 merge 流程，讓他再 commit 前做檢查。<br>規劃 code convertions，前端 Road Map ，補足前端 High Level Design Chart，upgrade technology version。</p>
<h3 id="Automation-Testing"><a href="#Automation-Testing" class="headerlink" title="Automation Testing"></a>Automation Testing</h3><p>在這期間也擔任自動化測試的 project lead，起初選擇的工具為 Selenium 搭配 Specflow，並使用 C#撰寫，期間我還不負責的訓練 QA 對於測試程式的撰寫，但後來因為職務調動，有了一個專職寫 automaion tesing 的 QA，也因他主要是前端轉 QA，我們下定決心把目前的自動化測試 solution 改為 cypree 搭配 Javascript 撰寫，在此也從中學習了不少。</p>
<h2 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h2><p>最後因為產品定位不明，公司政策改變等因素需要把產品回收，因此不得不做了決定，相信每個決定都是深思熟慮過的，但在我六年多的時間裡，對於產品與部門都十分熱愛，雖說沒有走到最後，但畢竟努力過了，且認真對待過就無悔了。在此職涯期間是我學習到最多東西的時期，不管對工作，對技術，對同事等，都大開了眼界，原來工作可以與生活並重，以往都被工作綁住，把所有時間都花在了工作上。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/08/24/Before-Merge-Checker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Leo Lee">
      <meta itemprop="description" content="A Software Engineer && A Basketball Fanatic && An Alcoholic">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小書僮，可笑可笑">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/24/Before-Merge-Checker/" class="post-title-link" itemprop="url">使用GitLab CI/CD在Merge前做預先檢查</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-08-24 17:54:59" itemprop="dateCreated datePublished" datetime="2022-08-24T17:54:59+08:00">2022-08-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-28 11:06:13" itemprop="dateModified" datetime="2022-12-28T11:06:13+08:00">2022-12-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="本文章可以幫你"><a href="#本文章可以幫你" class="headerlink" title="本文章可以幫你"></a>本文章可以幫你</h2><ol>
<li>GitLab Merge when pipleline succeeds設定</li>
<li>使用GitLab CI/CD</li>
<li>使用ESLint/StyleLint檢查程式碼</li>
</ol>
<h2 id="設定GitLab的Merge-when-pipeline-succeeds-啟動runners"><a href="#設定GitLab的Merge-when-pipeline-succeeds-啟動runners" class="headerlink" title="設定GitLab的Merge when pipeline succeeds/啟動runners"></a>設定GitLab的Merge when pipeline succeeds/啟動runners</h2><ol>
<li>官方文件可以參考 <a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/user/project/merge_requests/merge_when_pipeline_succeeds.html">site1</a><br><a target="_blank" rel="noopener" href="https://gitlab.ict888.net/help/ci/merge_request_pipelines/index.md#pipelines-for-merge-requests">site2</a></li>
<li>GitLab設定的位置[Repo] =&gt; Settings =&gt; General =&gt; Merge requests<br> <img src="/2022/08/24/Before-Merge-Checker/capture01.png"></li>
<li>記得啟動runners[Repo] =&gt; Settings =&gt; CI/CD =&gt; Runners<br> <img src="/2022/08/24/Before-Merge-Checker/capture02.png"></li>
</ol>
<h2 id="在專案裡面新增GitLab-CI-comfig"><a href="#在專案裡面新增GitLab-CI-comfig" class="headerlink" title="在專案裡面新增GitLab CI comfig"></a>在專案裡面新增GitLab CI comfig</h2><ol>
<li>新增.gitlab-ci.yml並設定其內容</li>
<li>設定workflow讓pipeline只在Merge Request Contenx建立的時候才執行<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflow:</span></span><br><span class="line">    <span class="attr">rules:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">if:</span> <span class="string">$CI_MERGE_REQUEST_ID</span> <span class="comment"># Execute jobs in merge request context</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">if:</span> <span class="string">$CI_COMMIT_BRANCH</span> <span class="string">==</span> <span class="string">&#x27;dev&#x27;</span> <span class="comment"># Execute jobs when a new commit is pushed to dev branch</span></span><br><span class="line"></span><br><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">prepare</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">check</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">deploy</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cache:</span></span><br><span class="line">  <span class="attr">paths:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">node_modules/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">install:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">prepare</span></span><br><span class="line"><span class="comment">#   only: =&gt; going to be deprecated，根據gitloab 11.x doc，即將被拋棄</span></span><br><span class="line"><span class="comment">#     - dev</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eslint:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">check</span></span><br><span class="line"><span class="comment">#   only: =&gt; going to be deprecated，根據gitloab 11.x doc，即將被拋棄</span></span><br><span class="line"><span class="comment">#     - dev</span></span><br><span class="line">  <span class="attr">dependencies:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">prepare</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">eslint</span> <span class="string">src/*.ts</span></span><br><span class="line"></span><br><span class="line"><span class="attr">stylelint:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">check</span></span><br><span class="line"><span class="comment">#   only: =&gt; going to be deprecated，根據gitloab 11.x doc，即將被拋棄</span></span><br><span class="line"><span class="comment">#     - dev</span></span><br><span class="line">  <span class="attr">dependencies:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">prepare</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">stylelint</span> <span class="string">src/css/**/*.scss</span></span><br><span class="line"></span><br><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">build</span></span><br><span class="line"><span class="comment">#   only: =&gt; going to be deprecated，根據gitloab 11.x doc，即將被拋棄</span></span><br><span class="line"><span class="comment">#     - dev</span></span><br><span class="line">  <span class="attr">dependencies:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">prepare</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">build</span></span><br><span class="line"></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">deploy</span></span><br><span class="line">  <span class="attr">script:</span> <span class="string">./deploy</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">if:</span> <span class="string">$CI_COMMIT_BRANCH</span> <span class="string">==</span> <span class="string">&#x27;dev&#x27;</span> <span class="comment"># Execute jobs when a new commit is pushed to dev branch</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="設定eslint-stylelint"><a href="#設定eslint-stylelint" class="headerlink" title="設定eslint/stylelint"></a>設定eslint/stylelint</h2><ol>
<li>安裝eslint與設定<ul>
<li>install packages<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install eslint eslint-config-prettier eslint-plugin-prettier @typescript-eslint/eslint-plugin @typescript-eslint/parser</span><br></pre></td></tr></table></figure></li>
<li>.eslintrc.js<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">env</span>: &#123;</span><br><span class="line">        <span class="attr">browser</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">es6</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">extends</span>: [</span><br><span class="line">        <span class="comment">// Uses the recommended rules from the @typescript-eslint/eslint-plugin</span></span><br><span class="line">        <span class="string">&quot;plugin:@typescript-eslint/recommended&quot;</span>,</span><br><span class="line">        <span class="comment">// Uses eslint-config-prettier to disable ESLint rules from @typescript-eslint/eslint-plugin that would conflict with prettier</span></span><br><span class="line">        <span class="string">&quot;prettier/@typescript-eslint&quot;</span>,</span><br><span class="line">        <span class="comment">// Enables eslint-plugin-prettier and eslint-config-prettier. This will display prettier errors as ESLint errors.</span></span><br><span class="line">        <span class="comment">// Make sure this is always the last configuration in the extends array.</span></span><br><span class="line">        <span class="string">&quot;plugin:prettier/recommended&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">globals</span>: &#123;</span><br><span class="line">        <span class="title class_">Atomics</span>: <span class="string">&quot;readonly&quot;</span>,</span><br><span class="line">        <span class="title class_">SharedArrayBuffer</span>: <span class="string">&quot;readonly&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">parser</span>: <span class="string">&quot;@typescript-eslint/parser&quot;</span>,</span><br><span class="line">    <span class="attr">parserOptions</span>: &#123;</span><br><span class="line">        <span class="attr">ecmaVersion</span>: <span class="number">2018</span>,</span><br><span class="line">        <span class="attr">sourceType</span>: <span class="string">&quot;module&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [<span class="string">&quot;@typescript-eslint&quot;</span>],</span><br><span class="line">    <span class="attr">rules</span>: &#123;</span><br><span class="line">        <span class="string">&quot;prettier/prettier&quot;</span>: [<span class="string">&quot;error&quot;</span>],</span><br><span class="line">        <span class="string">&quot;@typescript-eslint/no-explicit-any&quot;</span>: <span class="string">&quot;off&quot;</span>,</span><br><span class="line">        <span class="string">&quot;@typescript-eslint/interface-name-prefix&quot;</span>: <span class="string">&quot;off&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>使用<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eslint src/js/**/*.ts --fix</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>安裝stylelint與設定<ul>
<li>install packages<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install stylelint stylelint-config-prettier stylelint-config-sass-guidelines stylelint-config-standard stylelint-order stylelint-scss</span><br></pre></td></tr></table></figure></li>
<li>.stylelintrc.js<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">extends</span>: [<span class="string">&quot;stylelint-config-standard&quot;</span>, <span class="string">&quot;stylelint-config-sass-guidelines&quot;</span>],</span><br><span class="line">    <span class="attr">rules</span>: &#123;</span><br><span class="line">        <span class="attr">indentation</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="string">&quot;selector-max-id&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;max-nesting-depth&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;function-url-quotes&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;selector-class-pattern&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;selector-max-compound-selectors&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;selector-max-compound-selectors&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;selector-max-compound-selectors&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;selector-no-qualifying-type&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;no-descending-specificity&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;declaration-block-no-duplicate-properties&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;function-linear-gradient-no-nonstandard-direction&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;selector-id-pattern&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;font-family-no-missing-generic-family-keyword&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;function-no-unknown&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">&quot;max-line-length&quot;</span>: <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>使用<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stylelint src/css/**/*.scss --fix</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ol>
<h2 id="前置作業設定好了，試試看吧"><a href="#前置作業設定好了，試試看吧" class="headerlink" title="前置作業設定好了，試試看吧!"></a>前置作業設定好了，試試看吧!</h2><ol>
<li>執行後，可以從[Repo] =&gt; CI/CD =&gt; Piplelines/Jobs去看結果<br> <img src="/2022/08/24/Before-Merge-Checker/capture03.png"><br> <img src="/2022/08/24/Before-Merge-Checker/capture04.png"> </li>
<li>設定eslint error level去測試錯誤結果<br><img src="/2022/08/24/Before-Merge-Checker/capture05.png"><br>commit後pipeline因為eslint error跑失敗<br><img src="/2022/08/24/Before-Merge-Checker/capture06.png"><br>開了merge request會無法merge，需要先修正pipeline的錯誤<br><img src="/2022/08/24/Before-Merge-Checker/capture07.png"> </li>
</ol>
<h2 id="Enhancement-修改為當workflow成立時才可以Merge"><a href="#Enhancement-修改為當workflow成立時才可以Merge" class="headerlink" title="[Enhancement]修改為當workflow成立時才可以Merge"></a>[Enhancement]修改為當workflow成立時才可以Merge</h2><ol>
<li>將.gitlab ci config加上workflow rules<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflow:</span></span><br><span class="line">    <span class="attr">rules:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">if:</span> <span class="string">$CI_MERGE_REQUEST_ID</span> <span class="comment"># Execute jobs in merge request context</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">if:</span> <span class="string">$CI_COMMIT_BRANCH</span> <span class="string">==</span> <span class="string">&#x27;dev&#x27;</span> <span class="comment"># Execute jobs when a new commit is pushed to dev branch</span></span><br></pre></td></tr></table></figure></li>
<li>如此一來當在gitlab上開Merge request時，會自動跑CI/CD，成功後才可以去Merge<br><img src="/2022/08/24/Before-Merge-Checker/capture08.png"><br><img src="/2022/08/24/Before-Merge-Checker/capture09.png"></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/08/24/Gulp3-to-Gulp4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Leo Lee">
      <meta itemprop="description" content="A Software Engineer && A Basketball Fanatic && An Alcoholic">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小書僮，可笑可笑">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/24/Gulp3-to-Gulp4/" class="post-title-link" itemprop="url">將 Gulp3 升級至 Gulp4 之路</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-08-24 15:48:38" itemprop="dateCreated datePublished" datetime="2022-08-24T15:48:38+08:00">2022-08-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-28 11:06:13" itemprop="dateModified" datetime="2022-12-28T11:06:13+08:00">2022-12-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC/" itemprop="url" rel="index"><span itemprop="name">軟體開發</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="本文章可以幫你"><a href="#本文章可以幫你" class="headerlink" title="本文章可以幫你"></a>本文章可以幫你</h2><ol>
<li>使用NVM做nodeJS版本控管</li>
<li>將Gulp3升級至Gulp4</li>
<li>排除遇到的雷</li>
</ol>
<h2 id="安裝NVM與使用"><a href="#安裝NVM與使用" class="headerlink" title="安裝NVM與使用"></a>安裝NVM與使用</h2><ol>
<li>先安裝<a target="_blank" rel="noopener" href="https://github.com/coreybutler/nvm-windows/releases/tag/1.1.7">nvm windows</a></li>
<li>簡單的nvm指令<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nvm install [node version]</span><br><span class="line">nvm list</span><br><span class="line">nvm use [node version]</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="安裝Gulp到NVM"><a href="#安裝Gulp到NVM" class="headerlink" title="安裝Gulp到NVM"></a>安裝Gulp到NVM</h2><p>NVM會將node_modules裝到該NVM/[node version]目錄下，不是原本預設的 C:\Users[user name]\AppData\Roaming\npm，因此需要重新安裝npm install gulp -g </p>
<p><img src="/2022/08/24/Gulp3-to-Gulp4/capture01.png"></p>
<h2 id="安裝Gulp4後會需要修改的寫法"><a href="#安裝Gulp4後會需要修改的寫法" class="headerlink" title="安裝Gulp4後會需要修改的寫法"></a>安裝Gulp4後會需要修改的寫法</h2><ol>
<li>將 “run-sequence”改為gulp.series與gulp.parallel<ul>
<li>gulp3<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;my-task&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">runSequence</span>(</span><br><span class="line">        <span class="string">&quot;my-task1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;my-task2&quot;</span>,</span><br><span class="line">        [</span><br><span class="line">            <span class="string">&quot;my-task3&quot;</span>,</span><br><span class="line">            <span class="string">&quot;my-task4&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;run&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>gulp4<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;my-task&quot;</span>,</span><br><span class="line">    gulp.<span class="title function_">series</span>(</span><br><span class="line">        <span class="string">&quot;my-task1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;my-task2&quot;</span>,</span><br><span class="line">        gulp.<span class="title function_">parallel</span>(</span><br><span class="line">            <span class="string">&quot;my-task3&quot;</span>,</span><br><span class="line">            <span class="string">&quot;my-task4&quot;</span></span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">function</span>(<span class="params">cp</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;run&quot;</span>);</span><br><span class="line">            <span class="title function_">cp</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>將gulp.run改為tast() <ul>
<li>gulp3<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">run</span>(<span class="string">&quot;my-task&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;);</span><br></pre></td></tr></table></figure></li>
<li>gulp4<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;my-task&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>回傳值需要加上return<ul>
<li>gulp3<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;my-task&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    gulp.<span class="title function_">src</span>([<span class="string">&quot;./src&quot;</span>]).<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;build&quot;</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>gulp4<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;my-task&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>([<span class="string">&quot;./src&quot;</span>]).<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;build&quot;</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>呼叫task的時候需要預先定義好，因此需要把呼叫端方到後方</li>
<li>sass呼叫需要修改<ul>
<li>gulp3<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sass = <span class="built_in">require</span>(<span class="string">&quot;gulp-sass&quot;</span>);</span><br><span class="line">sass.<span class="property">compiler</span> = <span class="built_in">require</span>(<span class="string">&quot;sass&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li>gulp4<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sass = <span class="built_in">require</span>(<span class="string">&quot;gulp-sass&quot;</span>)(<span class="built_in">require</span>(<span class="string">&quot;sass&quot;</span>));</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/23/Linter-In-Private-NPM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Leo Lee">
      <meta itemprop="description" content="A Software Engineer && A Basketball Fanatic && An Alcoholic">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小書僮，可笑可笑">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/23/Linter-In-Private-NPM/" class="post-title-link" itemprop="url">建立 Linter Configuration Packages in Private NPM</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-11-23 17:12:57" itemprop="dateCreated datePublished" datetime="2021-11-23T17:12:57+08:00">2021-11-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-28 11:06:13" itemprop="dateModified" datetime="2022-12-28T11:06:13+08:00">2022-12-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC/" itemprop="url" rel="index"><span itemprop="name">軟體開發</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="本文章可以幫你"><a href="#本文章可以幫你" class="headerlink" title="本文章可以幫你"></a>本文章可以幫你</h2><ol>
<li>使用prettier rule定義eslint config </li>
<li>改寫default prettier rule</li>
<li>設定auto formatter by prettier in VS code setting </li>
<li>把config package publish到private NPM</li>
<li>下載使用config package</li>
</ol>
<h2 id="使用prettier-rule定義eslint-config"><a href="#使用prettier-rule定義eslint-config" class="headerlink" title="使用prettier rule定義eslint config"></a>使用prettier rule定義eslint config</h2><h3 id="基本規劃"><a href="#基本規劃" class="headerlink" title="基本規劃"></a>基本規劃</h3><p><img src="/2021/11/23/Linter-In-Private-NPM/capture01.png"></p>
<ol>
<li>建立一個使用prettier的linter base<br><img src="/2021/11/23/Linter-In-Private-NPM/capture02.png"><ul>
<li>.eslintrc.js<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">env</span>: &#123;</span><br><span class="line">        <span class="attr">browser</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">es6</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">extends</span>: [</span><br><span class="line">        <span class="string">&quot;plugin:prettier/recommended&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">globals</span>: &#123;</span><br><span class="line">        <span class="title class_">Atomics</span>: <span class="string">&quot;readonly&quot;</span>,</span><br><span class="line">        <span class="title class_">SharedArrayBuffer</span>: <span class="string">&quot;readonly&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">parser</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">parserOptions</span>: &#123;</span><br><span class="line">        <span class="attr">ecmaVersion</span>: <span class="number">2018</span>,</span><br><span class="line">        <span class="attr">sourceType</span>: <span class="string">&quot;module&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [<span class="string">&quot;eslint-plugin-prettier&quot;</span>],</span><br><span class="line">    <span class="attr">rules</span>: &#123;</span><br><span class="line">        <span class="string">&quot;prettier/prettier&quot;</span>: [<span class="string">&quot;error&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="改寫default-prettier-rule"><a href="#改寫default-prettier-rule" class="headerlink" title="改寫default prettier rule"></a>改寫default prettier rule</h2></li>
<li>.prettierrc.js<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">semi</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">singleQuote</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">printWidth</span>: <span class="number">120</span>,</span><br><span class="line">    <span class="attr">tabWidth</span>: <span class="number">4</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>根據不同程式語言或框架去定義不同的linter，以typescript為例<br><img src="/2021/11/23/Linter-In-Private-NPM/capture03.png"><ul>
<li>.eslintrc.js<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">env</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">extends</span>: [</span><br><span class="line">        <span class="comment">// inculing eslint base for javascript</span></span><br><span class="line">        <span class="string">&quot;../eslint-config-base/.eslintrc.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;plugin:@typescript-eslint/recommended&quot;</span>,</span><br><span class="line">        <span class="string">&quot;prettier/@typescript-eslint&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">globals</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">parser</span>: <span class="string">&quot;@typescript-eslint/parser&quot;</span>,</span><br><span class="line">    <span class="attr">parserOptions</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [],</span><br><span class="line">    <span class="attr">rules</span>: &#123;</span><br><span class="line">        <span class="string">&quot;@typescript-eslint/no-explicit-any&quot;</span>: <span class="string">&quot;off&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
設定好可以使用以下command去撈出目前所有載入的規則<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx eslint --print-config path::String</span><br></pre></td></tr></table></figure>
<img src="/2021/11/23/Linter-In-Private-NPM/capture07.png"></li>
</ul>
</li>
<li>測試rules<br><img src="/2021/11/23/Linter-In-Private-NPM/capture04.png"><ul>
<li>在package.json建立測試script<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">     <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eslint-config-leoru&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.eslintrc.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">         <span class="attr">&quot;eslint-test-base&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./node_modules/.bin/eslint test/*.* --config eslint-config-base/.eslintrc.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;eslint-test-js&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./node_modules/.bin/eslint test/*.js --config eslint-config-javascript/.eslintrc.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;eslint-test-ts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./node_modules/.bin/eslint ./test/typescript_test.ts --config eslint-config-typescript/.eslintrc.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;eslint-test-vue2.0&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./node_modules/.bin/eslint test/*.vue --config eslint-config-vue2.0/.eslintrc.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;eslint-test-vue3.0&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./node_modules/.bin/eslint test/*.vue --config eslint-config-vue3.0/.eslintrc.js&quot;</span></span><br><span class="line">     <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">         <span class="attr">&quot;@typescript-eslint/eslint-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.3.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;@typescript-eslint/parser&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.3.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;typescript&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.5.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;eslint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.4.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;eslint-config-prettier&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.3.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;eslint-plugin-prettier&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.1.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;eslint-plugin-vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^8.1.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;prettier&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.18.2&quot;</span></span><br><span class="line">     <span class="punctuation">&#125;</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
執行測試<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run eslint-test-ts</span><br></pre></td></tr></table></figure>
<img src="/2021/11/23/Linter-In-Private-NPM/capture05.png"></li>
</ul>
</li>
</ol>
<h2 id="設定auto-formatter-by-prettier-in-VS-code-setting"><a href="#設定auto-formatter-by-prettier-in-VS-code-setting" class="headerlink" title="設定auto formatter by prettier in VS code setting"></a>設定auto formatter by prettier in VS code setting</h2><p>在.vscode/setting.json設定<br><img src="/2021/11/23/Linter-In-Private-NPM/capture06.png"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;eslint.alwaysShowStatus&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eslint.options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;extensions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;.ts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;.js&quot;</span><span class="punctuation">,</span> <span class="string">&quot;.vue&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eslint.validate&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;typescript&quot;</span><span class="punctuation">,</span> <span class="string">&quot;javascript&quot;</span><span class="punctuation">,</span> <span class="string">&quot;vue&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;editor.defaultFormatter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esbenp.prettier-vscode&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;editor.codeActionsOnSave&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;source.fixAll.eslint&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;[javascript]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;editor.defaultFormatter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esbenp.prettier-vscode&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;editor.codeActionsOnSave&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;source.fixAll.eslint&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;[typescript]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;editor.defaultFormatter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esbenp.prettier-vscode&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;editor.codeActionsOnSave&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;source.fixAll.eslint&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;[vue]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;editor.defaultFormatter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esbenp.prettier-vscode&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;editor.codeActionsOnSave&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;source.fixAll.eslint&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;[html]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;editor.defaultFormatter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esbenp.prettier-vscode&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;[json]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;editor.defaultFormatter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esbenp.prettier-vscode&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;[css]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;editor.defaultFormatter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esbenp.prettier-vscode&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="把config-package-publish到private-NPM"><a href="#把config-package-publish到private-NPM" class="headerlink" title="把config package publish到private NPM"></a>把config package publish到private NPM</h2><p>先設定project name跟預設執行的main</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@eslint-config-leo/eslint-config-base&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.eslintrc.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;eslint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.4.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;eslint-config-prettier&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.3.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;eslint-plugin-prettier&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.1.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;prettier&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.18.2&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>然後發布吧!!!</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish</span><br></pre></td></tr></table></figure>
<h2 id="下載使用config-package"><a href="#下載使用config-package" class="headerlink" title="下載使用config package"></a>下載使用config package</h2><p>先安裝npm packages for eslint</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @eslint-config-leo/eslint-config-base --save-dev</span><br></pre></td></tr></table></figure>

<p>接著設定project .eslintrc.js and  .prettierrc.js</p>
<ul>
<li>.eslintrc.js<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">extends</span>: [<span class="string">&quot;@eslint-config-leo/base&quot;</span>] <span class="comment">//eslint-config-可以省略</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>.prettierrc.js<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    ...<span class="built_in">require</span>(<span class="string">&quot;./node_modules/@eslint-config-leo/eslint-config-base/.prettierrc.js&quot;</span>)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="接著大方地使用吧"><a href="#接著大方地使用吧" class="headerlink" title="接著大方地使用吧 ~~~~~"></a>接著大方地使用吧 ~~~~~</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/25/Establish-Private-NPM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Leo Lee">
      <meta itemprop="description" content="A Software Engineer && A Basketball Fanatic && An Alcoholic">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小小書僮，可笑可笑">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/25/Establish-Private-NPM/" class="post-title-link" itemprop="url">一條龍建立Private NPM by Verdaccio</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-25 12:12:57" itemprop="dateCreated datePublished" datetime="2021-02-25T12:12:57+08:00">2021-02-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-28 11:06:13" itemprop="dateModified" datetime="2022-12-28T11:06:13+08:00">2022-12-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC/" itemprop="url" rel="index"><span itemprop="name">軟體開發</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="本文章可以幫你"><a href="#本文章可以幫你" class="headerlink" title="本文章可以幫你"></a>本文章可以幫你</h2><ol>
<li>安裝與設定verdaccio</li>
<li>將verdaccio掛載到IIS</li>
<li>建立元件並發布到verdaccio</li>
<li>安裝元件並使用</li>
<li>把元件掛載到CI/CD Flow上</li>
<li>一些troubleshooting</li>
</ol>
<h2 id="安裝與設定verdaccio"><a href="#安裝與設定verdaccio" class="headerlink" title="安裝與設定verdaccio"></a>安裝與設定verdaccio</h2><p><strong>安裝十分簡單</strong><br>1.安裝verdaccio至globle</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install verdaccio -g</span><br></pre></td></tr></table></figure>
<p>2.啟動verdaccio</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ verdaccio</span><br></pre></td></tr></table></figure>
<p>於瀏覽器網址列打下 <a target="_blank" rel="noopener" href="http://localhost:4873/">http://localhost:4873/</a> 即可見到以下畫面<br><img src="/2021/02/25/Establish-Private-NPM/capture01.png"></p>
<p>P.S 如果上傳的package size過大，會出現以下錯誤訊息<br><img src="/2021/02/25/Establish-Private-NPM/capture09.png"><br>可於<br>C:\Users{username}\AppData\Roaming\verdaccio\config.yaml<br>加上<strong>max_body_size: 100mb</strong><br>C:\Users{username}.npmrc<br>加上<strong>max_body_size=100mb</strong></p>
<h2 id="將verdaccio掛載到IIS"><a href="#將verdaccio掛載到IIS" class="headerlink" title="將verdaccio掛載到IIS"></a>將verdaccio掛載到IIS</h2><p>local測試完成後，試著將verdaccio掛成一個服務吧!!<br>因為筆者公司的server為windows base，因此試著將他掛到IIS上<br>官網有十分詳細<a target="_blank" rel="noopener" href="https://verdaccio.org/docs/en/iss-server">教學</a></p>
<p>1.安裝iisnode<br>2.於安裝目錄執行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install</span><br></pre></td></tr></table></figure>
<p>3.將網站掛到IIS上<br><img src="/2021/02/25/Establish-Private-NPM/capture02.png"><br>4.因需要讓verdaccio去讀寫網站資料夾，因次需要增加角色給予full control<br><img src="/2021/02/25/Establish-Private-NPM/capture03.png"><br>5.增加Hanlder Mappings for iisnode並設定Feature Permission<br><img src="/2021/02/25/Establish-Private-NPM/capture04.png"><br><img src="/2021/02/25/Establish-Private-NPM/capture05.png"><br>完成後使用瀏覽器執行出現以下訊息，damnnnn!!!<br><img src="/2021/02/25/Establish-Private-NPM/capture06.png"><br>發現還需要指定nodejs執行的路徑 =&gt; <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/50244164/iisnode-module-is-unable-to-start-the-node-exe-process">issue</a><br><img src="/2021/02/25/Establish-Private-NPM/capture07.png"></p>
<p>完成設置!</p>
<h2 id="建立元件並發布到verdaccio"><a href="#建立元件並發布到verdaccio" class="headerlink" title="建立元件並發布到verdaccio"></a>建立元件並發布到verdaccio</h2><p>建立元件有幾個地方要注意<br>1.設置.npmignore，如果使用typescript的話，記得tsconfig.json一定要設定不然會造成路徑衝突<br>  <img src="/2021/02/25/Establish-Private-NPM/capture08.png"><br>2.因筆者建立的Private NPM沒有對外網路，因此選擇將package name加上scope並在.npmrc/.yarnrc設定不同registry<br>  <img src="/2021/02/25/Establish-Private-NPM/capture10.png"></p>
<p>  .npmrc<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@leo:registry=http://xx.xx.xx.xx:8089/</span><br></pre></td></tr></table></figure><br>  .yarnrc<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;@leo:registry&quot; &quot;http://xx.xx.xx.xx:8089/&quot;</span><br></pre></td></tr></table></figure><br>  可以讓npm install或yarn add要安裝scope內的packages時自動使用private NPM</p>
<h2 id="安裝元件並使用"><a href="#安裝元件並使用" class="headerlink" title="安裝元件並使用"></a>安裝元件並使用</h2><p>  1.安裝<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install @leo/common -s</span><br></pre></td></tr></table></figure><br>  2.想要讓程式對應到基礎元件，因此調整了tsconfig.json的baseUrl<br>    <img src="/2021/02/25/Establish-Private-NPM/capture11.png"></p>
<h2 id="把元件掛載到CI-CD-Flow上"><a href="#把元件掛載到CI-CD-Flow上" class="headerlink" title="把元件掛載到CI/CD Flow上"></a>把元件掛載到CI/CD Flow上</h2><p>  1.建立Build and Publish Job，使用windows batch<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm publish --registry http://xx.xx.xx.xx:8089/ --always-auth false</span><br></pre></td></tr></table></figure><br>  2.建立版本自動遞增規則<br>  <img src="/2021/02/25/Establish-Private-NPM/capture12.png"><br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ IF NOT &quot;%version%&quot; == &quot;none&quot; (</span><br><span class="line">$   git reset --hard</span><br><span class="line">$   npm version %version%</span><br><span class="line">$   git push &quot;origin&quot; --tags</span><br><span class="line">$   git push &quot;origin&quot; HEAD:master</span><br><span class="line">$ ) </span><br></pre></td></tr></table></figure><br>  3.建立GitLab webhook，版控Merged自動trigger job<br>  <img src="/2021/02/25/Establish-Private-NPM/capture13.png"></p>
<p>  如此一來CI/CD Flow也完成，流程如下:<br>  =&gt; branch merge to master<br>  =&gt; auto trigger jenkins job<br>  =&gt; build package and publish to private NPM<br>  =&gt; version update and push tag to origin</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Leo Lee</p>
  <div class="site-description" itemprop="description">A Software Engineer && A Basketball Fanatic && An Alcoholic</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Leo Lee</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
